{%- assign preset = image_preset | default: 'default' -%}
{%- assign setting = srcsets[preset] -%}
{%- assign sizes = false -%}
{%- assign src = image -%}
{%- assign srcset = false -%}
{%- unless image contains 'svg' -%}
  {%- assign path = image | replace_first: '/images',app.imgcdn -%}
  {%- assign sizes = setting.sizes -%}
  {%- capture src %}{{ path }}?w={{ setting.sources[0].width | default: 'auto' }}&h={{ setting.sources[0].height | default: 'auto' }}&q={{ setting.sources[0].quality | default: '100' }}&crop={{ setting.crop | default: 'edges' | replace: ',','%2C' }}&auto=format{% endcapture -%}
  {%- capture srcset %}{% for source in setting.sources %}{{ path }}?w={{ source.width | default: 'auto' }}&h={{ source.height | default: 'auto' }}&q={{ source.quality | default: '100' }}&crop={{ setting.crop | default: 'edges' | replace: ',','%2C' }}&auto=format {{ source.width }}w{% unless forloop.last %}, {% endunless%}{% endfor %}{% endcapture -%}
{%- endunless -%}
<img src="{{ src }}" alt="{{ alt }}"{% if id %} id="{{ id }}"{% endif %}{% if image_class %} class="{{ image_class }}"{% endif %}{% if srcset %} data-preset="{{ preset }}" srcset="{{ srcset }}"{% endif %}{% if sizes %} sizes="{{ sizes }}"{% endif %}{% if setting.sources[0].width %} width="{{ setting.sources[0].width }}"{% endif %}{% if setting.sources[0].height %} height="{{ setting.sources[0].height }}"{% endif %} lazyload="on">
